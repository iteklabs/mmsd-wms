<!DOCTYPE html>
<html lang="en">

<head>
    <%- include('./partials/head'); -%>

</head>

<body onload="SelectRoom(); SelectRoom_QA(); showCategorize();">
    <!--*******************
        Preloader start
    ********************-->
    <div id="preloader">
        <div class="sk-three-bounce">
            <div class="sk-child sk-bounce1"></div>
            <div class="sk-child sk-bounce2"></div>
            <div class="sk-child sk-bounce3"></div>
        </div>
    </div>
    <!--*******************
        Preloader end
    ********************-->

    <!--**********************************
        Main wrapper start
    ***********************************-->
    <div id="main-wrapper">

        <!--**********************************
            Nav header start
        ***********************************-->
        <%- include('./partials/header_logo'); -%>

            <!--**********************************
            Nav header end
        ***********************************-->

            <!--**********************************
            Header start
        ***********************************-->
            <%- include('./partials/header',{titel: language.sales_return}); -%>

                <!--**********************************
            Header end ti-comment-alt
        ***********************************-->

                <!--**********************************
            Sidebar start
        ***********************************-->
                <%- include('./partials/sidebar'); -%>

                    <!--**********************************
            Sidebar end
        ***********************************-->

                    <div class="content-body">
                        <div class="container-fluid">

                            <!-- row -->
                            <div class="row">
                                <div class="col-lg-12">
                                    <div class="card">
                                        <div class="card-header">
                                            <h4 class="card-title"><%= language.edit_sale_return %> </h4>
                                            <button type="button" class="btn btn-rounded btn-outline-info"
                                                onclick="history.back()"><i class="la la-undo"></i> <%= language.go_back %> </button>
                                        </div>
                                        <div class="card-body">
                                            <div class="form-validation">

                                                <form class="needs-validation"
                                                    action="/all_sales_finished/view/return_sales/<%= user._id %>"
                                                    method="post" id="form">

                                                    <div class="row mb-3">
                                                        <div class="col-xl-3 col-sm-6">
                                                            <div class="form-group">
                                                                <label for="invoice_no"><%= language.invoice %> </label>
                                                                <input type="text" name="invoice"
                                                                    value="<%= user.invoice %>" class="form-control"
                                                                    id="invoice" readonly>
                                                            </div>
                                                        </div>
                                                        <div class="col-xl-3 col-sm-6">
                                                            <div class="form-group">
                                                                <label for="invoice_no"><%= language.customer %> </label>
                                                                <input type="text" name="customer"
                                                                    value="<%= user.customer %>" class="form-control"
                                                                    id="customer" readonly>
                                                            </div>
                                                        </div>
                                                        <div class="col-xl-3 col-sm-6">
                                                            <div class="form-group">
                                                                <label for="invoice_no"><%= language.date %> </label>
                                                                <input type="date" name="date" class="form-control"
                                                                    id="date" value="<%= user.date %>" required>
                                                            </div>
                                                        </div>
                                                        <div class="col-xl-3 col-sm-6">
                                                            <div class="form-group">
                                                                <label for="invoice_no">Previous <%= language.warehouse %> </label>
                                                                <input type="text" name="warehouse_name"
                                                                    value="<%= user.warehouse_name %>" class="form-control"
                                                                    id="warehouse_name" readonly>
                                                            </div>
                                                        </div>

                                                        <div class="col-xl-3 col-sm-6">
                                                            <div class="form-group">
                                                                <label for="invoice_no">Previous Room</label>
                                                                <input type="text" name="Room_name"
                                                                    value="<%= user.room %>" class="form-control"
                                                                    id="Room_name" readonly>
                                                            </div>
                                                        </div>

                                                    
                                                
                                                    <div class="col-xl-3 col-sm-6">
                                                        <div class="form-group">
                                                            <label for="invoice_no"> <span
                                                                    class="text-red"></span></label>
                                                            <select class="form-control" name="for_categorize"
                                                                id="for_categorize" onchange="TypeList(); CheckingBin(); showCategorize();  " required>
                                                                <option value="QA">QA </option>
                                                                <option value="GS">GOOD STOCKS</option>
                                                            </select>
                                                        </div>
                                                    </div>



                                                <div class="row" id="goods_section" style="display: none;" >
                                                    <div class="col-xl-3 col-sm-6">
                                                        <div class="form-group">
                                                            <label for="invoice_no">To <%= language.warehouse %>  <span
                                                                    class="text-red">*</span></label>
                                                            <select class="form-control" name="to_warehouse_name"
                                                                id="warehouse_name3" onchange="SelectRoom(); TypeList(); CheckingBin();" required>
                                                                <% warehouses.forEach((warehouse)=> { %>
                                                                    <option value="<%= warehouse.name %>">
                                                                        <%= warehouse.name %>
                                                                    </option>
                                                                    <% }) %>
                                                            </select>
                                                        </div>
                                                    </div>


                                                    <div class="col-xl-3 col-sm-6">
                                                        <div class="form-group">
                                                            <label for="invoice_no">To Room  <span
                                                                    class="text-red">*</span></label>
                                                            <select class="form-control" name="to_Room_name"
                                                                id="Room_name3" onchange="CheckingBin(); TypeList(); CheckingBin();">
                                      
                                                            </select>
                                                        </div>
                                                    </div>
                                                


                                                    <div class="col-xl-12">
                                                        <div class="table-responsive">
                                                            <table class="table primary-table-bordered" id="myTable">
                                                                <thead class="thead-primary">
                                                                    <tr>
                                                                        <th scope="col"><%= language.name %> </th>
                                                                        <th scope="col">Primary Code</th>
                                                                        <th scope="col">Secondary Code</th>
                                                                        <th scope="col">Product Code</th>
                                                                        <th scope="col">Level</th>
                                                                        <th scope="col">Location</th>
                                                                        <th scope="col"><%= language.sale_qty %> </th>
                                                                        <th scope="col"><%= language.return_qty %>  <span class="text-red">*</span></th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <% var x = 0; %>
                                                                    <% user.sale_product.forEach((user)=> { %>
                                                                    <tr>

                                                                        
                                                                        <td scope="col" class="align-top">
                                                                            <input type="text" name="product_name"
                                                                                class="form-control" style="width: 350px;" id="product_name"
                                                                                value="<%= user.product_name %>"
                                                                                readonly>
                                                                        </td>

                                                                        <td scope="col" class="align-top">
                                                                            <div class="input-group"> 
                                                                                <input type="text" name="primary_code" class="form-control primary_code" style="width: 150px;" id="primary_code" value="<%= user.primary_code %>" readonly> 
                                                                              
                                                                            </div>
                                                                        </td>


                                                                        <td scope="col" class="align-top">
                                                                            <div class="input-group"> 
                                                                                <input type="text" name="secondary_code" class="form-control secondary_code" style="width: 150px;"  id="secondary_code" value="<%= user.secondary_code %>" readonly> 
                                                                              
                                                                            </div>
                                                                        </td>


                                                                        <td scope="col" class="align-top">
                                                                            <div class="input-group"> 
                                                                                <input type="text" name="product_code" class="form-control product_code" style="width: 150px;"  id="product_code" value="<%= user.product_code %>" readonly> 
                                                                              
                                                                            </div>
                                                                        </td>

                                                                        <!-- <td scope="col" class="align-top">
                                                                            <div class="input-group"> 
                                                                                <input type="text" name="bay" class="form-control bay" style="width: 150px;"  id="bay" value="<%= user.bay %>"> 
                                                                              
                                                                            </div>
                                                                        </td> -->


                                                                        <td scope="col" class="align-top">
                                                                            <div class="input-group"> 
                                                                                <!-- <input type="text" name="bay" class="form-control bay" style="width: 150px;"  id="bay" value="<%= user.bay %>">  -->

                                                                                <select class="form-control" name="bay"  id="bay<%= x %>" style="width: 150px;" onchange="BayBin('<%= x %>');"></select>
                                                                              
                                                                            </div>
                                                                        </td>


                                                                        <td scope="col" class="align-top">
                                                                            <div class="input-group"> 
                                                                              <select class="form-control" name="pallet" level="levelOslie<%= x %>" id="pallet<%= x %>" style="width: 150px;"></select>                                                                                                                                                          
                                                                            </div>
                                                                        </td>



                                                                        



                                                                        <td scope="col" class="align-top">
                                                                            <div class="input-group"> 
                                                                                <input type="text" name="sales_quantity" class="form-control sales_quantity" style="width: 150px;"  id="sales_quantity" value="<%= user.quantity %>" readonly> 
                                                                              
                                                                            </div>
                                                                        </td>

                                                                        <% if (stock.length == 0) { %>
                                                                            <td scope="col" class="align-top">
                                                                                <div class="input-group"> 
                                                                                    <input type="text" name="stocks" class="form-control stocks" style="width: 150px;"  id="stocks" value="0" readonly> 
                                                                                  
                                                                                </div>
                                                                            </td>
                                                                        <% } else { %>

                                                                            <% stock.forEach((stocksdata)=> { %>
                                                                                <% if (user.product_name == stocksdata.name &&  user.level == stocksdata.level &&  user.isle == stocksdata.isle &&  user.pallet == stocksdata.pallet  && user.expiry_date == stocksdata.expiry_date && user.batch_code == stocksdata.batch_code && user.production_date == stocksdata.production_date && stocksdata.room == user.room_name) { %>
                  
                                                                                    <!-- <td scope="col" class="align-top">
                                                                                        <div class="input-group"> 
                                                                                            <input type="text" name="stocks" class="form-control stocks" style="width: 150px;"  id="stocks" value="<%= stocksdata.product_stock %>" readonly> 
                                                                                          
                                                                                        </div>
                                                                                    </td> -->

                                                                                    <input type="hidden" name="maxPerUnit" class="form-control maxPerUnit" id="maxPerUnit" value="<%= stocksdata.maxPerUnit %>"> 
                                                                                    <input type="hidden" name="maxProducts" class="form-control maxProducts" id="maxProducts" value="<%= stocksdata.maxProducts %>"> 
                                                                                    <input type="hidden" name="batch_code" class="form-control batch_code" id="batch_code" value="<%= stocksdata.batch_code %>">
                                                                                    <input type="hidden" name="secondary_unit" class="form-control secondary_unit" id="secondary_unit" value="<%= stocksdata.secondary_unit %>"> 
                                                                                    <input type="hidden" name="unit" class="form-control unit" id="unit" value="<%= stocksdata.unit %>">  
                                                                                    <input type="hidden" name="production_date" class="form-control production_date" id="production_date" value="<%= stocksdata.production_date %>">  
                                                                                    <input type="hidden" name="expiry_date" class="form-control expiry_date" id="expiry_date" value="<%= stocksdata.expiry_date %>">  
                                                                             
                                                                                <% } %>
                                                                            <% }) %>

                                                                        <% } %>
                                                                       
                                                    

                                                                        <td scope="col" class="align-top">
                                                                            <div class="input-group"> 
                                                                                <input type="text" name="return_qty" class="form-control return_qty" style="width: 150px;"  id="return_qty" value=""> 
                                                                                
                                                                            </div>
                                                                        </td>

                                                                    </tr>
                                                                    <% x++ %>
                                                                    <% }) %>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>




                                                <div class="row" id="QA-section" style="display: none;" >
                                                    <div class="col-xl-3 col-sm-6">
                                                        <div class="form-group">
                                                            <label for="invoice_no">To <%= language.warehouse %>  <span
                                                                    class="text-red">*</span></label>
                                                            <select class="form-control" name="to_warehouse_name_QA"
                                                                id="warehouse_name3_QA" onchange="SelectRoom_QA();" required>
                                                                <% warehouse_QA.forEach((warehouse)=> { %>
                                                                    <option value="<%= warehouse.name %>">
                                                                        <%= warehouse.name %>
                                                                    </option>
                                                                    <% }) %>
                                                            </select>
                                                        </div>
                                                    </div>


                                                    <div class="col-xl-3 col-sm-6">
                                                        <div class="form-group">
                                                            <label for="invoice_no">To Room  <span
                                                                    class="text-red">*</span></label>
                                                            <select class="form-control" name="to_Room_name_QA"
                                                                id="Room_name3_QA" required>
                                      
                                                            </select>
                                                        </div>
                                                    </div>
                                                


                                                    <div class="col-xl-12">
                                                        <div class="table-responsive">
                                                            <table class="table primary-table-bordered">
                                                                <thead class="thead-primary">
                                                                    <tr>
                                                                        <th scope="col"><%= language.name %> </th>
                                                                        <th scope="col">Primary Code</th>
                                                                        <th scope="col">Secondary Code</th>
                                                                        <th scope="col">Product Code</th>
                                                                        <th scope="col">Room</th>
                                                                        <th scope="col">Level</th>
                                                                        <th scope="col">Location</th>
                                                                        <th scope="col"><%= language.sale_qty %> </th>
                                                   
                                                                        <th scope="col"><%= language.return_qty %>  <span class="text-red">*</span></th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <% user.sale_product.forEach((user)=> { %>
                                                                    <tr>

                                                                        
                                                                        <td scope="col" class="align-top">
                                                                            <input type="text" name="product_name_QA1"
                                                                                class="form-control" style="width: 400px;" id="product_name_QA1"
                                                                                value="<%= user.product_name %>"
                                                                                readonly>
                                                                        </td>

                                                                        <td scope="col" class="align-top">
                                                                            <div class="input-group"> 
                                                                                <input type="text" name="primary_code_QA" class="form-control primary_code" style="width: 150px;" id="primary_code_QA" value="<%= user.primary_code %>" readonly> 
                                                                              
                                                                            </div>
                                                                        </td>


                                                                        <td scope="col" class="align-top">
                                                                            <div class="input-group"> 
                                                                                <input type="text" name="secondary_code_QA" class="form-control secondary_code" style="width: 150px;"  id="secondary_code_QA" value="<%= user.secondary_code %>" readonly> 
                                                                              
                                                                            </div>
                                                                        </td>


                                                                        <td scope="col" class="align-top">
                                                                            <div class="input-group"> 
                                                                                <input type="text" name="product_code_QA" class="form-control product_code" style="width: 150px;"  id="product_code_QA" value="<%= user.product_code %>" readonly> 
                                                                              
                                                                            </div>
                                                                        </td>


                                                                        <td scope="col" class="align-top">
                                                                            <div class="input-group"> 
                                                                                <input type="text" name="room_QA" class="form-control product_code" style="width: 150px;"  id="room_QA" value="<%= user.room_name %>" readonly> 
                                                                              
                                                                            </div>
                                                                        </td>


                                                                        <td scope="col" class="align-top">
                                                                            <div class="input-group"> 
                                                                                <input type="text" name="level_QA" class="form-control level_QA" style="width: 150px;"  id="level_QA" value="<%= user.level %>" readonly> 
                                                                              
                                                                            </div>
                                                                        </td>


                                                                        <td scope="col" class="align-top">
                                                                            <div class="input-group"> 
                                                                                <input type="text" name="pallet_QA" class="form-control pallet_QA" style="width: 150px;"  id="pallet_QA" value="<%= user.isle+user.pallet %>" readonly> 
                                                                              
                                                                            </div>
                                                                        </td>


                                                                        <td scope="col" class="align-top">
                                                                            <div class="input-group"> 
                                                                                <input type="text" name="sales_quantity_QA" class="form-control sales_quantity" style="width: 150px;"  id="sales_quantity_QA" value="<%= user.quantity %>" readonly> 
                                                                              
                                                                            </div>
                                                                        </td>

                                                                        <% if (stock.length == 0) { %>
                                                                            <!-- <td scope="col" class="align-top">
                                                                                <div class="input-group"> 
                                                                                    <input type="text" name="stocks_QA" class="form-control stocks" style="width: 150px;"  id="stocks_QA" value="0" readonly> 
                                                                                  
                                                                                </div>
                                                                            </td> -->
                                                                        <% } else { %>

                                                                            <% stock.forEach((stocksdata)=> { %>
                                                                               
                                                                                <% if (user.product_name == stocksdata.name &&  user.level == stocksdata.level &&  user.isle == stocksdata.isle &&  user.pallet == stocksdata.pallet  && user.expiry_date == stocksdata.expiry_date && user.batch_code == stocksdata.batch_code && user.production_date == stocksdata.production_date && stocksdata.room == user.room_name) { %>

                                                                                    <input type="hidden" name="maxPerUnit_QA" class="form-control maxPerUnit_QA" id="maxPerUnit_QA" value="<%= stocksdata.maxPerUnit %>"> 
                                                                                    <input type="hidden" name="maxProducts_QA" class="form-control maxProducts_QA" id="maxProducts_QA" value="<%= stocksdata.maxProducts %>"> 
                                                                                    <input type="hidden" name="batch_code_QA" class="form-control batch_code_QA" id="batch_code_QA" value="<%= stocksdata.batch_code %>">
                                                                                    <input type="hidden" name="secondary_unit_QA" class="form-control secondary_unit_QA" id="secondary_unit_QA" value="<%= stocksdata.secondary_unit %>"> 
                                                                                    <input type="hidden" name="unit_QA" class="form-control unit_QA" id="unit_QA" value="<%= stocksdata.unit %>">  
                                                                                    <input type="hidden" name="production_date_QA" class="form-control production_date_QA" id="production_date_QA" value="<%= stocksdata.production_date %>">  
                                                                                    <input type="hidden" name="expiry_date_QA" class="form-control expiry_date_QA" id="expiry_date_QA" value="<%= stocksdata.expiry_date %>">  
                                                                             
                                                                                <% } %>
                                                                            <% }) %>

                                                                        <% } %>
                                                                       
                                                                        

                                                                        <td scope="col" class="align-top">
                                                                            <div class="input-group"> 
                                                                                <input type="text" name="return_qty_QA" class="form-control return_qty" style="width: 150px;"  id="return_qty_QA" value=""> 
                                                                                
                                                                            </div>
                                                                        </td>

                                                                    </tr>
                                                                    <% }) %>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                                    <div class="row">
                                                        <div class="col-md-8 col-sm-6">
                                                            <div class="form-group">
                                                                <label for="note"><%= language.return_note %> </label>
                                                                <input type="text" class="form-control" id="note"
                                                                    placeholder="Enter Note" name="note">
                                                            </div>
                                                        </div>

                                                   

                                                    </div>

                                                    <div class="row">
                                                        <button class="btn btn-primary" type="submit"
                                                            id="submit"><%= language.submit %> </button>
                                                    </div>

                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!--**********************************
            Footer start
        ***********************************-->
                    <%- include('./partials/footer'); -%>

                        <!--**********************************
            Footer end
        ***********************************-->

    </div>
    <!--**********************************
        Main wrapper end
    ***********************************-->

    <!-- start Toastr -->
    <%- include('./partials/toastr'); -%>
        <!-- End Toastr -->

        <!--**********************************
        Scripts
    ***********************************-->

        <%- include('./partials/script'); -%>

        <script>
            function SelectRoom(){
        
                var varibale = document.getElementById("warehouse_name3").value;
                var selectRoom = $('#Room_name3');

                $.ajax({
                    url: '/warehousemap_Income/Rooms_data3', 
                    method: 'POST',
                    data: { warehouse_name: varibale }, 
                    success: function(response) {

                    
                        selectRoom.empty();
                            $.each(response, function(index, data) {
                                var roomName = data.room_name;
                                var roomCode = data.room_name
                                var option = $('<option>').text(roomName).val(roomName).attr('roomcode', roomCode);;
                                selectRoom.append(option);
                            })


                        
                    }
                })

                
                
            }

            function SelectRoom_QA(){
                var varibale = document.getElementById("warehouse_name3_QA").value;
                var selectRoom = $('#Room_name3_QA');

                $.ajax({
                    url: '/warehousemap_Income/Rooms_data3', 
                    method: 'POST',
                    data: { warehouse_name: varibale }, 
                    success: function(response) {

                    
                        selectRoom.empty();
                            $.each(response, function(index, data) {
                                var roomName = data.room_name;
                                var roomCode = data.room_name
                                var option = $('<option>').text(roomName).val(roomName).attr('roomcode', roomCode);;
                                selectRoom.append(option);
                            })


                        
                    }
                })
            }
        
            function showCategorize(){
                var for_categorize = document.getElementById("for_categorize").value;
                var goods_section = document.getElementById("goods_section")
                var QA_section = document.getElementById("QA-section")


                if (for_categorize === "GS") {
                    goods_section.style.display = "block";
                    QA_section.style.display = "none";
                    SelectRoom();
                }else{
                    goods_section.style.display = "none";
                    QA_section.style.display = "block"; 
                    SelectRoom_QA();
                }

                BayBin()

            }
       
            function TypeList(){
                    var levelType = document.getElementsByName("bay");
                    var warehouse = document.getElementById("warehouse_name3").value;
                    var room = document.getElementById("Room_name3").value
                    var Location;

                    if(warehouse == "Pasig"){
                        // alert(room)
                        switch(room){
                            case "Ambient":
                            type = [1, 2 ,3, 4];
                            break;
                            case "Enclosed":
                            type = [1,2,3,4];
                            break;
                        }

                        
                        for (let index = 0; index < levelType.length; index++) {
                            const element = levelType[index];
                            var optionsHtml = '';
                            type.forEach(function (num) {
                                optionsHtml += '<option value="' + num + '">' + num + '</option>';
                            });

                            levelType[index].innerHTML = optionsHtml;
                            
                        }

                            
                            
                    }else {
                        switch(room){
                            case "Ambient":
                            type = [1];
                            break;
                        }

                        var optionsHtml = '';
                        for (let index = 0; index < levelType.length; index++) {
                            const element = levelType[index];
                            
                            type.forEach(function (num) {
                                optionsHtml += '<option value="' + num + '">' + num + '</option>';
                            });

                            levelType[index].innerHTML = optionsHtml;
                            
                        }
                    } 
                }
       
                function BayBin(x){
                    const selectlevel= document.querySelectorAll(`select[level="levelOslie`+x+`"]`);
                    var warehouse = document.getElementById("warehouse_name3").value;
                    var room = document.getElementById("Room_name3").value;
                    var levelType = document.getElementById("bay"+x);
                    var levels = [];
                    let outputArray = [];
                    if(warehouse == "Pasig"){
                        switch(room){
                            case "Ambient":

                                if(levelType.value == 1){   
                                    const letterRanges = [
                                        { letter: 'A', min: 1, max: 54 },
                                        { letter: 'B', min: 55, max: 108 },
                                        { letter: 'C', min: 109, max: 162 },
                                        { letter: 'D', min: 163, max: 216 },
                                        { letter: 'E', min: 217, max: 270 },
                                        { letter: 'F', min: 271, max: 324 },
                                        { letter: 'G', min: 325, max: 362 },
                                        { letter: 'H', min: 363, max: 400 },
                                        { letter: 'I', min: 401, max: 438 },
                                        { letter: 'J', min: 439, max: 476 }
                                    ];

                                    for (const range of letterRanges) {
                                        const { letter, min, max } = range;
                                        for (let i = min; i <= max; i++) {
                                            levels.push(letter + i);
                                        }
                                    }

                                }else if(levelType.value == 2){
                                    const letterRanges = [
                                    { letter: 'A', min: 477, max: 530 },
                                    { letter: 'B', min: 531, max: 584 },
                                    { letter: 'C', min: 585, max: 638 },
                                    { letter: 'D', min: 639, max: 692 },
                                    { letter: 'E', min: 693, max: 746 },
                                    { letter: 'F', min: 747, max: 800 },
                                    { letter: 'G', min: 801, max: 838 },
                                    { letter: 'H', min: 839, max: 876 },
                                    { letter: 'I', min: 877, max: 914 },
                                    { letter: 'J', min: 915, max: 952 }
                                    ];

                                    for (const range of letterRanges) {
                                        const { letter, min, max } = range;
                                        for (let i = min; i <= max; i++) {
                                            levels.push(letter + i);
                                        }
                                    }
                                }else if(levelType.value == 3){
                                    const letterRanges = [
                                    { letter: 'A', min: 953, max: 1006 },
                                    { letter: 'B', min: 1007, max: 1060 },
                                    { letter: 'C', min: 1061, max: 1114 },
                                    { letter: 'D', min: 1115, max: 1168 },
                                    { letter: 'E', min: 1169, max: 1222 },
                                    { letter: 'F', min: 1223, max: 1276 },
                                    { letter: 'G', min: 1277, max: 1314 },
                                    { letter: 'H', min: 1315, max: 1352 },
                                    { letter: 'I', min: 1353, max: 1390 },
                                    { letter: 'J', min: 1391, max: 1428 }
                                    ];

                                    for (const range of letterRanges) {
                                        const { letter, min, max } = range;
                                        for (let i = min; i <= max; i++) {
                                            levels.push(letter + i);
                                        }
                                    }
                                }else if(levelType.value == 4){
                                    const letterRanges = [
                                    { letter: 'A', min: 1429, max: 1482 },
                                    { letter: 'B', min: 1483, max: 1536 },
                                    { letter: 'C', min: 1537, max: 1590 },
                                    { letter: 'D', min: 1591, max: 1644 },
                                    { letter: 'E', min: 1645, max: 1698 },
                                    { letter: 'F', min: 1699, max: 1752 },
                                    { letter: 'G', min: 1753, max: 1790 },
                                    { letter: 'H', min: 1791, max: 1828 },
                                    { letter: 'I', min: 1829, max: 1868 },
                                    { letter: 'J', min: 1867, max: 1904 }
                                    ];

                                    for (const range of letterRanges) {
                                        const { letter, min, max } = range;
                                        for (let i = min; i <= max; i++) {
                                            levels.push(letter + i);
                                        }
                                    }
                                }

                                
                            break;
                            case "Enclosed":
                            if(levelType.value == 1){   
                                    const letterRanges = [        
                                        { letter: 'G', min: 1, max: 13 },
                                        { letter: 'H', min: 14, max: 27 },
                                        { letter: 'I', min: 28, max: 41 },
                                        { letter: 'J', min: 42, max: 55 }
                                    ];

                                    for (const range of letterRanges) {
                                        const { letter, min, max } = range;
                                        for (let i = min; i <= max; i++) {
                                            levels.push(letter + i);
                                        }
                                    }

                                }else if(levelType.value == 2){
                                    const letterRanges = [        
                                        { letter: 'G', min: 56, max: 68 },
                                        { letter: 'H', min: 69, max: 82 },
                                        { letter: 'I', min: 83, max: 96 },
                                        { letter: 'J', min: 97, max: 110 }
                                    ];

                                    for (const range of letterRanges) {
                                        const { letter, min, max } = range;
                                        for (let i = min; i <= max; i++) {
                                            levels.push(letter + i);
                                        }
                                    }
                                }else if(levelType.value == 3){
                                    const letterRanges = [        
                                        { letter: 'G', min: 111, max: 123 },
                                        { letter: 'H', min: 124, max: 137 },
                                        { letter: 'I', min: 138, max: 151 },
                                        { letter: 'J', min: 152, max: 165 }
                                    ];

                                    for (const range of letterRanges) {
                                        const { letter, min, max } = range;
                                        for (let i = min; i <= max; i++) {
                                            levels.push(letter + i);
                                        }
                                    }
                                }else if(levelType.value == 4){
                                    const letterRanges = [        
                                        { letter: 'G', min: 166, max: 178 },
                                        { letter: 'H', min: 179, max: 192 },
                                        { letter: 'I', min: 193, max: 206 },
                                        { letter: 'J', min: 207, max: 220 }
                                    ];

                                    for (const range of letterRanges) {
                                        const { letter, min, max } = range;
                                        for (let i = min; i <= max; i++) {
                                            levels.push(letter + i);
                                        }
                                    }
                                }
                            break;

                            case "AISLE":
                            levels = [0];
                            break;
                        }
                        
                        for (let i = 0; i < selectlevel.length; i++) {
                            var optionsHtml = '';
                            levels.forEach(function (num) {
                                optionsHtml += '<option value="' + num + '">' + num + '</option>';
                            });
                            selectlevel[i].innerHTML = optionsHtml;
                        }        
                        
                    }else if(warehouse == "Iloilo"){
                        switch(room){
                            case "Ambient":
                            if(levelType.value == 1){   
                                    const letterRanges = [
                                        { letter: 'A', min: 1, max: 54 },
                                        { letter: 'B', min: 55, max: 108 },
                                        { letter: 'C', min: 109, max: 145 }
                                    ];

                                    for (const range of letterRanges) {
                                        const { letter, min, max } = range;
                                        for (let i = min; i <= max; i++) {
                                            levels.push(letter + i);
                                        }
                                    }

                                }
                            break;
                            
                        }
                        
                        for (let i = 0; i < selectlevel.length; i++) {
                            var optionsHtml = '';
                            levels.forEach(function (num) {
                                optionsHtml += '<option value="' + num + '">' + num + '</option>';
                            });
                            selectlevel[i].innerHTML = optionsHtml;
                        }        
                        
                }else if(warehouse == "Bacolod"){
                        switch(room){
                            case "Ambient":
                            if(levelType.value == 1){   
                                    const letterRanges = [
                                        { letter: 'A', min: 1, max: 54 },
                                        { letter: 'B', min: 55, max: 60 },
                                    ];

                                    for (const range of letterRanges) {
                                        const { letter, min, max } = range;
                                        for (let i = min; i <= max; i++) {
                                            levels.push(letter + i);
                                        }
                                    }

                                }
                            break;
                            
                        }
                        
                        for (let i = 0; i < selectlevel.length; i++) {
                            var optionsHtml = '';
                            levels.forEach(function (num) {
                                optionsHtml += '<option value="' + num + '">' + num + '</option>';
                            });
                            selectlevel[i].innerHTML = optionsHtml;
                        }        
                        
                }else if(warehouse == "Cebu"){
                        switch(room){
                            case "Ambient":
                            if(levelType.value == 1){   
                                    const letterRanges = [
                                        { letter: 'A', min: 1, max: 54 },
                                        { letter: 'B', min: 55, max: 108 },
                                        { letter: 'C', min: 109, max: 150 },
                                    ];

                                    for (const range of letterRanges) {
                                        const { letter, min, max } = range;
                                        for (let i = min; i <= max; i++) {
                                            levels.push(letter + i);
                                        }
                                    }

                                }
                            break;
                            
                        }
                        
                        for (let i = 0; i < selectlevel.length; i++) {
                            var optionsHtml = '';
                            levels.forEach(function (num) {
                                optionsHtml += '<option value="' + num + '">' + num + '</option>';
                            });
                            selectlevel[i].innerHTML = optionsHtml;
                        }        
                        
                }else if(warehouse == "Tacloban"){
                        switch(room){
                            case "Ambient":
                            if(levelType.value == 1){   
                                    const letterRanges = [
                                        { letter: 'A', min: 1, max: 54 },
                                        { letter: 'B', min: 55, max: 194 },
                                    ];

                                    for (const range of letterRanges) {
                                        const { letter, min, max } = range;
                                        for (let i = min; i <= max; i++) {
                                            levels.push(letter + i);
                                        }
                                    }

                                }
                            break;
                            
                        }
                        
                        for (let i = 0; i < selectlevel.length; i++) {
                            var optionsHtml = '';
                            levels.forEach(function (num) {
                                optionsHtml += '<option value="' + num + '">' + num + '</option>';
                            });
                            selectlevel[i].innerHTML = optionsHtml;
                        }        
                        
                }else if(warehouse == "Davao"){
                        switch(room){
                            case "Ambient":
                            if(levelType.value == 1){   
                                    const letterRanges = [
                                        { letter: 'A', min: 1, max: 54 },
                                        { letter: 'B', min: 55, max: 108 },
                                        { letter: 'C', min: 109, max: 150 },
                                    ];

                                    for (const range of letterRanges) {
                                        const { letter, min, max } = range;
                                        for (let i = min; i <= max; i++) {
                                            levels.push(letter + i);
                                        }
                                    }

                                }
                            break;
                            
                        }
                        
                        for (let i = 0; i < selectlevel.length; i++) {
                            var optionsHtml = '';
                            levels.forEach(function (num) {
                                optionsHtml += '<option value="' + num + '">' + num + '</option>';
                            });
                            selectlevel[i].innerHTML = optionsHtml;
                        }        
                        
                }else if(warehouse == "CDO"){
                        switch(room){
                            case "Ambient":
                            if(levelType.value == 1){   
                                    const letterRanges = [
                                        { letter: 'A', min: 1, max: 54 },
                                        { letter: 'B', min: 55, max: 108 },
                                        { letter: 'C', min: 109, max: 162 },
                                        { letter: 'D', min: 163, max: 200 },
                                    ];

                                    for (const range of letterRanges) {
                                        const { letter, min, max } = range;
                                        for (let i = min; i <= max; i++) {
                                            levels.push(letter + i);
                                        }
                                    }

                                }
                            break;
                            
                        }
                        
                        for (let i = 0; i < selectlevel.length; i++) {
                            var optionsHtml = '';
                            levels.forEach(function (num) {
                                optionsHtml += '<option value="' + num + '">' + num + '</option>';
                            });
                            selectlevel[i].innerHTML = optionsHtml;
                        }        
                        
                }else if(warehouse == "Zamboanga"){
                        switch(room){
                            case "Ambient":
                            if(levelType.value == 1){   
                                    const letterRanges = [
                                        { letter: 'A', min: 1, max: 50 },
                                    ];

                                    for (const range of letterRanges) {
                                        const { letter, min, max } = range;
                                        for (let i = min; i <= max; i++) {
                                            levels.push(letter + i);
                                        }
                                    }

                                }
                            break;
                            
                        }
                        
                        for (let i = 0; i < selectlevel.length; i++) {
                            var optionsHtml = '';
                            levels.forEach(function (num) {
                                optionsHtml += '<option value="' + num + '">' + num + '</option>';
                            });
                            selectlevel[i].innerHTML = optionsHtml;
                        }        
                        
                }
            }   
       
       
            function CheckingBin(){
                const table = document.getElementById("myTable");
                const rowCount = table.getElementsByTagName("tr").length-1;
                for (let index = 0; index < rowCount; index++) {
                    BayBin(index);
                    
                }
            }
       
       </script>

            <!--**********************************
        Scripts end
    ***********************************-->
</body>

</html>